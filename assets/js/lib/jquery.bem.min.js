(function(d,f){var m=function(a){this.config=a||{};this.version="1.3.0"};m.prototype={getBlock:function(a,b){b=b||null;var c=this._getBlockClass(a),e=a.closest("."+c);e.selector=c;return b?e.elem(b):e},switchBlock:function(a,b,c){(c=c||null)?a.selector=this._buildSelector({block:b,elem:c}):a.selector=this._buildSelector({block:b});return a},findElem:function(a,b){var c=this._getBlockClass(a),c=this._buildElemClass(c,b);return a.find("."+c)},getMod:function(a,b){var c=this._extractMods(a.first());
    return c[b]!=f?c[b]:null},hasMod:function(a,b,c){a=this._extractMods(a.first());if(c){if(a[b]==c)return!0}else if(a[b])return!0;return!1},setMod:function(a,b,c){var e=this,k=a.selector;a.each(function(){var a=d(this);a.selector=k;var g=e._extractMods(a),n=e._getBaseClass(a);g[b]!=f&&(g=e._buildModClass(n,b,g[b]),a.removeClass(g));if(!1!==c)var l=e._buildModClass(n,b,c);a.addClass(l).trigger("setmod",[b,c])});return a},delMod:function(a,b,c){var e=this,k=a.selector;a.each(function(){var a=d(this);
    a.selector=k;var g=e._extractMods(a),n=e._getBaseClass(a);if(c){if(g[b]==c)var f=e._buildModClass(n,b,g[b])}else f=e._buildModClass(n,b,g[b]);a.removeClass(f).trigger("delmod",[b,c])});return a},byMod:function(a,b,c,e){var k=this;c=c||null;e=e||!1;var h=a.selector,g=d();a.each(function(){var a=d(this);a.selector=h;var l=k._extractMods(a),m=k._getBaseClass(a);if(c){if(l[b]==c)var p=k._buildModClass(m,b,l[b])}else l[b]!=f&&(p=k._buildModClass(m,b,l[b]));g=g.add(e?a.not("."+p):a.filter("."+p))});g.selector=
    h;return g},_extractBlocks:function(a){var b=this,c=[];a=this._getClasses(a);d.each(a,function(a,d){var h=b._getClassType(d);"block"==h?c.push(d):"elem"==h&&(h=d.split(b.config.elemPrefix),c.push(h[0]))});return c},_extractElems:function(a){var b=this,c=[];d.each(b._getClasses(a),function(a,d){if("elem"==b._getClassType(d)){var h=d.split(b.config.elemPrefix);c.push(h[1])}});return c},_extractMods:function(a){var b=this,c={};a.each(function(){var a=d(this);d.each(b._getClasses(a),function(a,d){if("mod"==
    b._getClassType(d)){var e=b._buildModClassRe().exec(d)[1].split(b.config.modDlmtr);c[e[0]]=e[1]!==f&&!1!==e[1]?e[1]:!0}})});return c},_getClasses:function(a){var b=[];if("object"==typeof a)if(0===a.selector.indexOf("."))a=a.selector.split(".");else if(a.attr("class")!=f)a=a.attr("class").split(" ");else return null;else a=a.split(".");d.each(a,function(a,e){""!=e&&b.push(d.trim(e))});return b},_buildBlockClassRe:function(){return new RegExp("^("+this.config.namePattern+")$")},_buildElemClassRe:function(){return new RegExp("^"+
    this.config.namePattern+this.config.elemPrefix+"("+this.config.namePattern+")$")},_buildModClassRe:function(){return new RegExp("^(?:"+this.config.namePattern+"|"+this.config.namePattern+this.config.elemPrefix+this.config.namePattern+")"+this.config.modPrefix+"("+this.config.namePattern+"(("+this.config.modDlmtr+this.config.namePattern+")$|$))")},_buildBlockClass:function(a){return a},_buildElemClass:function(a,b){return a+this.config.elemPrefix+b},_buildModClass:function(a,b,c){return c!==f&&!0!==
c?a+this.config.modPrefix+b+this.config.modDlmtr+c:a+this.config.modPrefix+b},_buildSelector:function(a,b){""!==b&&(b=b||".");if("object"==typeof a&&a.block!=f){var c=this._buildBlockClass(a.block);a.elem!=f&&(c=this._buildElemClass(c,a.elem));if(a.mod!=f)var d=a.mod.split(":"),c=this._buildModClass(c,d[0],d[1])}return c!=f?b+c:b+a},_getBlockClass:function(a,b){var c=this._extractBlocks(a);b=b||0;return b<=c.length-1?c[b]:null},_getBaseClass:function(a){var b=this,c=null;a=this._getClasses(a);d.each(a,
    function(a,d){var f=b._getClassType(d);f&&"mod"!=f&&(c=d)});return c},_getClassType:function(a){return this._buildModClassRe().test(a)?"mod":this._buildElemClassRe().test(a)?"elem":this._buildBlockClassRe().test(a)?"block":null}};d.BEM=new m({namePattern:"[a-zA-Z0-9-]+",elemPrefix:"__",modPrefix:"_",modDlmtr:"_"});d.fn.extend({block:function(a){return d.BEM.getBlock(this,a)},elem:function(a){return d.BEM.findElem(this,a)},ctx:function(a,b){return d.BEM.switchBlock(this,a,b)},mod:function(a,b){"undefined"==
typeof b&&(b=null);return!1===b?d.BEM.delMod(this,a):null!=b?d.BEM.setMod(this,a,b):d.BEM.getMod(this,a)},setMod:function(a,b){return d.BEM.setMod(this,a,b)},delMod:function(a,b){return d.BEM.delMod(this,a,b)},hasMod:function(a,b){return d.BEM.hasMod(this,a,b)},byMod:function(a,b){return d.BEM.byMod(this,a,b)},byNotMod:function(a,b){return d.BEM.byMod(this,a,b,"inverse")}})})(jQuery,void 0);